# üìÖ –°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è TuranSound

## –û–±–∑–æ—Ä

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è 5-—à–∞–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Supabase, —ç—Å–∫—Ä–æ—É-—Å—á–µ—Ç–∞–º–∏ –∏ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **BookingsPage** (`/components/BookingsPage.tsx`)
   - –ì–ª–∞–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
   - –í–∫–ª–∞–¥–∫–∏: –í—Å–µ / –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ / –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ, –Ω–∞ —ç—Å–∫—Ä–æ—É, –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
   - –î–µ–π—Å—Ç–≤–∏—è: –æ—Ç–º–µ–Ω–∞, —Å–≤—è–∑—å —Å –∞—Ä—Ç–∏—Å—Ç–æ–º, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, –æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤

2. **EnhancedBookingModal** (`/components/EnhancedBookingModal.tsx`)
   - 5-—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:
     - –®–∞–≥ 1: –î–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (—Ç–∏–ø, –¥–∞—Ç–∞, –º–µ—Å—Ç–æ, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
     - –®–∞–≥ 2: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ (–∑–≤—É–∫, —Å–≤–µ—Ç, –≤–∏–¥–µ–æ, –≤–µ–¥—É—â–∏–π)
     - –®–∞–≥ 3: –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
     - –®–∞–≥ 4: –û–ø–ª–∞—Ç–∞ –∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
     - –®–∞–≥ 5: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

### –•—É–∫–∏

1. **useBookings** (`/hooks/useBookings.ts`)
   - –ë–∞–∑–æ–≤—ã–π —Ö—É–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–µ–π bookings
   - –ú–µ—Ç–æ–¥—ã: `createBooking`, `updateBookingStatus`

2. **useBookingsWithArtists** (`/hooks/useBookingsWithArtists.ts`)
   - –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ö—É–∫ —Å JOIN –∫ —Ç–∞–±–ª–∏—Ü–µ –∞—Ä—Ç–∏—Å—Ç–æ–≤
   - –ú–µ—Ç–æ–¥—ã: `cancelBooking`, `completeBooking`, `refetch`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `bookings`

```sql
CREATE TABLE bookings (
  id UUID PRIMARY KEY,
  customer_id UUID NOT NULL,
  artist_id UUID NOT NULL REFERENCES artists_catalog(id),
  
  -- –î–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
  event_type TEXT NOT NULL,
  event_date DATE NOT NULL,
  event_time TIME,
  event_duration INTEGER, -- –º–∏–Ω—É—Ç—ã
  event_location TEXT,
  event_city TEXT,
  guest_count INTEGER,
  special_requests TEXT,
  
  -- –§–∏–Ω–∞–Ω—Å—ã
  total_price NUMERIC NOT NULL,
  currency TEXT DEFAULT 'KZT',
  payment_status TEXT DEFAULT 'pending', -- pending, paid, escrow, released, refunded
  escrow_amount NUMERIC DEFAULT 0,
  
  -- –°—Ç–∞—Ç—É—Å—ã
  status TEXT DEFAULT 'pending', -- pending, confirmed, in_progress, completed, cancelled, disputed
  
  -- –ö–æ–Ω—Ç—Ä–∞–∫—Ç
  contract_signed BOOLEAN DEFAULT false,
  contract_url TEXT,
  
  -- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  confirmed_at TIMESTAMP,
  completed_at TIMESTAMP,
  cancelled_at TIMESTAMP
);
```

## –ü—Ä–æ—Ü–µ—Å—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
const { createBooking } = useBookings(userId);

const result = await createBooking({
  artistId: 'artist-uuid',
  eventType: '–°–≤–∞–¥—å–±–∞',
  eventDate: '2026-06-15',
  eventTime: '18:00',
  eventDuration: 180, // 3 —á–∞—Å–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö
  eventLocation: 'Rixos Almaty Hotel',
  eventCity: '–ê–ª–º–∞—Ç—ã',
  guestCount: 150,
  specialRequests: '–ú–∏–∫—Å –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Å–µ–Ω',
  totalPrice: 450000,
  currency: 'KZT'
});
```

### 2. –°—Ç–∞—Ç—É—Å—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

- **pending** - –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞—Ä—Ç–∏—Å—Ç–∞
- **confirmed** - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –æ–±–µ–∏–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏
- **in_progress** - –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –∏–¥—ë—Ç
- **completed** - –ó–∞–≤–µ—Ä—à–µ–Ω–æ
- **cancelled** - –û—Ç–º–µ–Ω–µ–Ω–æ
- **disputed** - –°–ø–æ—Ä–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

### 3. –°—Ç–∞—Ç—É—Å—ã –æ–ø–ª–∞—Ç—ã

- **pending** - –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
- **paid** - –û–ø–ª–∞—á–µ–Ω–æ
- **escrow** - –°—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ —ç—Å–∫—Ä–æ—É-—Å—á—ë—Ç–µ
- **released** - –í—ã–ø–ª–∞—á–µ–Ω–æ –∞—Ä—Ç–∏—Å—Ç—É
- **refunded** - –í–æ–∑–≤—Ä–∞—â–µ–Ω–æ –∑–∞–∫–∞–∑—á–∏–∫—É

## –ó–∞—â–∏—Ç–∞ —ç—Å–∫—Ä–æ—É

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤–∞ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –Ω–∞ —ç—Å–∫—Ä–æ—É-—Å—á—ë—Ç–µ
2. –°—Ä–µ–¥—Å—Ç–≤–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
3. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –∞—Ä—Ç–∏—Å—Ç—É
4. –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∑–∞–∫–∞–∑—á–∏–∫—É (—Å —É—á—ë—Ç–æ–º —É—Å–ª–æ–≤–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞)

### –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

- 3% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –í–∫–ª—é—á–∞–µ—Ç –∑–∞—â–∏—Ç—É —ç—Å–∫—Ä–æ—É –∏ —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É

## –°–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç

### –£—Å–ª–æ–≤–∏—è

- **–®—Ç—Ä–∞—Ñ –∑–∞ —Å—Ä—ã–≤**: 50% –æ—Ç —Å—É–º–º—ã
- **–§–æ—Ä—Å-–º–∞–∂–æ—Ä**: –ø–æ–ª–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç
- **–û—Ç–º–µ–Ω–∞ –∑–∞ 7+ –¥–Ω–µ–π**: –≤–æ–∑–≤—Ä–∞—Ç 90%
- **–û—Ç–º–µ–Ω–∞ –∑–∞ 3-7 –¥–Ω–µ–π**: –≤–æ–∑–≤—Ä–∞—Ç 50%
- **–û—Ç–º–µ–Ω–∞ –º–µ–Ω–µ–µ 3 –¥–Ω–µ–π**: –≤–æ–∑–≤—Ä–∞—Ç 25%

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª—É–≥:

1. **–ó–≤—É–∫–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ** - 150,000 ‚Ç∏
2. **–°–≤–µ—Ç–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ** - 120,000 ‚Ç∏
3. **–í–∏–¥–µ–æ—Å—ä—ë–º–∫–∞** - 180,000 ‚Ç∏
4. **–í–µ–¥—É—â–∏–π –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è** - 100,000 ‚Ç∏

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ UI

### –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
// –í App.tsx
const handleBook = (artistId: string) => {
  if (!currentUser) {
    toast.info('–í–æ–π–¥–∏—Ç–µ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è');
    handleNavigate('login');
    return;
  }
  setBookingArtist(artistId);
};
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

```typescript
// –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
handleNavigate('bookings');
```

## API –∑–∞–ø—Ä–æ—Å—ã

### –ü–æ–ª—É—á–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π —Å –∞—Ä—Ç–∏—Å—Ç–∞–º–∏

```typescript
const { data } = await supabase
  .from('bookings')
  .select(`
    *,
    artist:artists_catalog!artist_id (
      id, stage_name, avatar, rating, city, genres
    )
  `)
  .eq('customer_id', userId)
  .order('created_at', { ascending: false });
```

### –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
const { cancelBooking } = useBookingsWithArtists(userId);
await cancelBooking(bookingId);
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è

```typescript
const { completeBooking } = useBookingsWithArtists(userId);
await completeBooking(bookingId);
```

## RLS (Row Level Security)

–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ê—Ä—Ç–∏—Å—Ç—ã –≤–∏–¥—è—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –≥–¥–µ –æ–Ω–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏
- –°–æ–∑–¥–∞–≤–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—á–∏–∫–∏
- –û–±–Ω–æ–≤–ª—è—Ç—å –º–æ–≥—É—Ç –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞—Ä—Ç–∏—Å—Ç–æ–º
- ‚úÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞ –¥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
- ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏ –∑–∞–ø—Ä–æ—Å –æ—Ç–∑—ã–≤–∞
- ‚úÖ –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ß–∞—Ç** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–∞—Ç–∞ –º–µ–∂–¥—É –∑–∞–∫–∞–∑—á–∏–∫–æ–º –∏ –∞—Ä—Ç–∏—Å—Ç–æ–º
2. **–û—Ç–∑—ã–≤—ã** - –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
3. **–ö–∞–ª–µ–Ω–¥–∞—Ä—å** - –í–∏–∑—É–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
4. **–ü–ª–∞—Ç–µ–∂–∏** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –ø–ª–∞—Ç—ë–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
5. **PDF –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
6. **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∏—Å—å–º–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ –∞—Ä—Ç–∏—Å—Ç–æ–≤
3. –í—ã–±–µ—Ä–∏—Ç–µ –∞—Ä—Ç–∏—Å—Ç–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ 5 —à–∞–≥–æ–≤ —Ñ–æ—Ä–º—ã
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "–ú–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è"

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î

```sql
-- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
SELECT 
  b.*,
  a.stage_name as artist_name
FROM bookings b
LEFT JOIN artists_catalog a ON b.artist_id = a.id
ORDER BY b.created_at DESC;
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. –ù–∞—Å—Ç—Ä–æ–π–∫—É Supabase (SUPABASE_SETUP.md)
2. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
3. RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
